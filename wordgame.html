<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Word Ddakji: Flip Modes!</title>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&family=Radio+Canada+Big:ital,wght@0,400..700;1,400..700&display=swap" rel="stylesheet">
    
    
    
        <link rel="icon" type="image/x-icon" href="data:image/png;base64,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">

    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    <style>
        /* General Body Styles */
        
        
       @font-face {
    font-family: 'RadioC'; /* You can name it whatever you like */
    src: url('radioc.ttf') format('truetype'); /* The path is just the filename */
} 
        
        
      @font-face {
    font-family: 'Gamify'; /* You can name it whatever you like */
    src: url('gamify.ttf') format('truetype'); /* The path is just the filename */
 }
        
        
        
        
        
        body {
            font-family: 'Radio Canada Big', sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background: linear-gradient(135deg, #7F00FF, #E100FF); /* Vibrant gradient */
            margin: 0;
            overflow-y: auto; /* Allow scrolling if content overflows vertically */
            overflow-x: hidden; /* Prevent horizontal scrolling */
            color: #fff;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
            padding: 10px; /* Add some padding to body to ensure game container doesn't touch edges */
            box-sizing: border-box; /* Include padding in element's total width and height */
        }

        /* Game Container */
        .game-container {
            background-color: rgba(0, 0, 0, 0.7); /* Semi-transparent dark background */
            border-radius: 20px;
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.5);
            padding: 30px;
            text-align: center;
            width: 95%; /* Use a slightly larger percentage */
            max-width: 550px;
            animation: fadeIn 1s ease-out;
            position: relative;
            overflow: hidden;
            border: 3px solid #ffcc00; /* Gold border */
            box-sizing: border-box;
            min-height: 500px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            margin: auto; /* Center the container horizontally with auto margins */
        }

        /* Title */
        h1 {
            font-family: 'Press Start 2P', cursive;
            color: #ffcc00; /* Gold color */
            margin-bottom: 20px;
            font-size: 2em;
            letter-spacing: 2px;
            text-shadow: 4px 4px #4a008a; /* Retro shadow */
            word-break: break-word; /* Allow title to break words if too long */
        }

        /* Game Screens Area - Holds all individual screens */
        .game-screen-area {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            width: 100%;
            flex-grow: 1;
        }

        /* General Screen styles */
        .screen {
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 10px 0;
            width: 100%;
            box-sizing: border-box;
            flex-grow: 1;
            gap: 15px;
        }

        .screen.active {
            display: flex;
        }

        /* Buttons */
        .btn {
            background-color: #00FF7F; /* Bright green */
            color: #212121;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            font-size: 1.2em;
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.2s ease;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
            font-family: 'Press Start 2P', cursive;
            letter-spacing: 1px;
            /* Removed white-space: nowrap; to allow text wrapping */
            text-align: center; /* Center text within the button */
            word-break: break-word; /* Allow words to break if they are too long */
            min-width: 120px; /* Ensure a minimum width for buttons */
            line-height: 1.5; /* 1.5 times the font size */
        }

        .btn:hover {
            background-color: #00DD6E;
            transform: translateY(-2px);
        }

        .btn:active {
            transform: translateY(0);
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
        }

        .btn-secondary {
            background-color: #555;
            color: #fff;
        }

        .btn-secondary:hover {
            background-color: #777;
        }

        .btn-danger {
            background-color: #dc3545;
            color: #fff;
        }

        .btn-danger:hover {
            background-color: #c82333;
        }

        /* Specific styles for the Quit Game button */
        #quit-game-button {
            margin-top: auto;
            align-self: center;
            padding: 10px 20px;
            font-size: 1em;
        }


        /* Mode Selection Specific Styles */
        .mode-options-container {
            display: flex;
            flex-direction: column;
            gap: 12px;
            width: 80%;
            max-width: 300px;
            /* Center the container */
            margin-left: auto;
            margin-right: auto;
        }

        .mode-options-container .btn {
            width: 100%; /* Make buttons fill the container width */
            font-size: 1em;
            padding: 12px 8px;
        }

        .mode-selection-screen-text {
            font-size: 1.1em;
            margin-bottom: 15px;
            line-height: 1.4;
            max-width: 90%;
            color: #ffcc00;
            text-shadow: 2px 2px #4a008a;
            text-align: center;
            word-break: break-word;
        }
        /* Adjusted margin for back button in mode selection */
        #mode-selection-screen #back-to-main-button {
            margin-top: 25px;
        }

        /* Start Screen specific */
        #start-screen p {
            margin-bottom: 25px;
            font-size: 1.1em;
            line-height: 1.5;
            text-align: center;
            word-break: break-word;
        }
        /* New styles for the additional buttons on start screen */
        .start-screen-buttons {
            display: flex;
            flex-direction: column;
            gap: 15px;
            width: 80%;
            max-width: 300px;
            margin-top: 20px;
            /* Center the container */
            margin-left: auto;
            margin-right: auto;
        }
        .start-screen-buttons .btn {
            width: 100%;
        }


        /* Game UI */
        #word-display {
            font-size: 2.8em;
            font-weight: bold;
            margin-top: 15px;
            margin-bottom: 25px;
            min-height: 1.5em;
            color: #fff;
            font-family: 'Press Start 2P', cursive;
            text-shadow: 3px 3px #8a004a;
            word-wrap: break-word;
            word-break: break-word; /* Added for better compatibility */
            text-align: center;
        }

        .choices-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center; /* Center items when they wrap */
            gap: 15px;
            margin-top: 15px;
            width: 100%;
            min-width: 260px;
            margin-bottom: 25px;
        }

        .choice-box {
            background-color: #333;
            border: 2px solid #666;
            border-radius: 12px;
            padding: 15px 12px;
            font-size: 1.3em;
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.3s ease, border-color 0.3s ease, transform 0.2s ease;
            flex: 1 1 150px; /* Allow boxes to grow and shrink, with a preferred basis */
            min-width: 110px;
            max-width: 180px; /* Keep a max width to prevent boxes from becoming too wide */
            height: auto; /* Allow height to adjust based on content */
            min-height: 60px;
            display: flex;
            justify-content: center;
            align-items: center;
            box-shadow: 0 3px 6px rgba(0, 0, 0, 0.3);
            color: #fff;
            text-align: center;
            word-wrap: break-word;
            word-break: break-word; /* Added for better compatibility */
        }

        .choice-box:hover {
            background-color: #555;
            transform: translateY(-3px);
        }

        .choice-box.correct {
            background-color: #28a745;
            border-color: #218838;
            animation: pulseGreen 0.5s ease-out;
        }

        .choice-box.wrong {
            background-color: #dc3545;
            border-color: #c82333;
            animation: shake 0.5s ease-out;
        }

        #score-turn-container {
            width: 100%;
            padding: 0 8px;
            box-sizing: border-box;
            display: flex; /* Use flexbox for score and turn */
            justify-content: space-between; /* Space out score and turn */
            align-items: center;
        }

        #score-display, #turn-display {
            font-size: 1.3em;
            font-weight: bold;
            color: #ffcc00;
            text-shadow: 2px 2px #4a008a;
        }

        /* End Screen */
        #end-screen .btn {
            margin-top: 25px;
        }
        #final-score {
            font-size: 2.8em;
            font-weight: bold;
            color: #00FF7F;
            margin-bottom: 8px;
            font-family: 'Press Start 2P', cursive;
            text-shadow: 4px 4px #212121;
            word-break: break-word;
        }

        #final-message {
            font-size: 1.6em;
            margin-bottom: 25px;
            color: #fff;
            text-shadow: 2px 2px #4a008a;
            word-break: break-word;
        }

        /* Confirmation Screen Specific */
        .confirmation-screen p {
            font-size: 1.4em;
            margin-bottom: 25px;
            color: #fff;
            text-shadow: 2px 2px #4a008a;
            text-align: center;
            word-break: break-word;
        }

        .confirmation-buttons {
            display: flex;
            gap: 15px;
            flex-wrap: wrap; /* Allow buttons to wrap */
            justify-content: center; /* Center buttons when they wrap */
        }
        .confirmation-buttons .btn {
             margin-top: 0;
             flex: 1 1 120px; /* Allow buttons to grow/shrink with a basis */
             max-width: 180px; /* Max width for confirmation buttons */
        }

        /* Mode Info Screen Specific Styles */
        #mode-info-screen h2 {
            font-family: 'Press Start 2P', cursive;
            color: #00FF7F; /* Green for headings */
            margin-bottom: 20px;
            font-size: 1.8em;
            text-shadow: 3px 3px #212121;
            word-break: break-word;
        }

        #mode-info-screen p {
            font-size: 1.1em;
            line-height: 1.6;
            margin-bottom: 15px;
            text-align: center;
            max-width: 90%;
            color: #fff;
            word-break: break-word;
        }

        #mode-info-screen ul {
            text-align: left;
            list-style: none;
            padding: 0;
            margin-bottom: 20px;
            max-width: 90%; /* Limit list width */
            margin-left: auto; /* Center the list */
            margin-right: auto;
        }

        #mode-info-screen ul li {
            margin-bottom: 8px;
            font-size: 1.1em;
            color: #fff;
            word-break: break-word;
        }

        #mode-info-screen ul li strong {
            color: #ffcc00; /* Gold for mode names */
        }

        #mode-info-screen ul li:before {
            content: "• ";
            color: #00FF7F;
            font-weight: bold;
            display: inline-block;
            width: 1em;
            margin-left: -1em;
        }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-8px); }
            20%, 40%, 60%, 80% { transform: translateX(8px); }
        }

        @keyframes pulseGreen {
            0% { transform: scale(1); }
            50% { transform: scale(1.03); }
            100% { transform: scale(1); }
        }

        /* Confetti Effect (Simple Circles) */
        .confetti {
            position: absolute;
            width: 8px;
            height: 8px;
            background-color: #ffcc00;
            border-radius: 50%;
            opacity: 0;
            animation: fadeOutUp 2s forwards;
            z-index: 100;
        }

        .confetti:nth-child(2n) { background-color: #00FF7F; animation-delay: 0.2s; }
        .confetti:nth-child(3n) { background-color: #E100FF; animation-delay: 0.4s; }
        .confetti:nth-child(4n) { background-color: #7F00FF; animation-delay: 0.6s; }

        @keyframes fadeOutUp {
            0% { opacity: 1; transform: translateY(0) rotate(0deg); }
            100% { opacity: 0; transform: translateY(-400px) rotate(720deg); }
        }

        /* Timer Bar */
        #timer-bar-container {
            width: 100%;
            height: 12px;
            background-color: #555;
            border-radius: 6px;
            margin-top: 15px;
            overflow: hidden;
            box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.3);
        }

        #timer-bar {
            width: 100%;
            height: 100%;
            background-color: #ffcc00;
            border-radius: 6px;
            transition: width linear;
        }

        /* --- Responsive Adjustments (Media Queries) --- */
        @media (max-width: 768px) { /* Tablets and smaller */
            .game-container {
                padding: 20px;
                min-height: 450px;
            }
            h1 {
                font-size: 1.6em;
            }
            #word-display {
                font-size: 2em;
            }
            .btn {
                padding: 10px 20px;
                font-size: 1.1em;
                min-width: 100px; /* Adjust min-width for smaller screens */
            }
             .mode-options-container .btn,
             .start-screen-buttons .btn {
                 padding: 10px 6px; /* Adjust padding for mode/start buttons */
             }
            .choice-box {
                font-size: 1.1em;
                padding: 12px 8px;
                min-height: 55px;
                flex-basis: calc(50% - 10px); /* Two columns on smaller screens */
                max-width: calc(50% - 10px);
            }
            .choices-container {
                 gap: 10px; /* Adjust gap for two columns */
            }
            #score-display, #turn-display {
                font-size: 1.1em;
            }
            #final-score {
                font-size: 2.2em;
            }
            #final-message {
                font-size: 1.4em;
            }
            .mode-options-container .btn {
                font-size: 0.95em;
            }
            .confirmation-screen p {
                font-size: 1.2em;
            }
            #quit-game-button {
                padding: 8px 18px;
            }
             #mode-info-screen h2 {
                font-size: 1.5em;
            }
            #mode-info-screen p, #mode-info-screen ul li {
                font-size: 1em;
            }
            .confirmation-buttons .btn {
                 flex-basis: calc(50% - 10px); /* Two columns for confirmation buttons */
                 max-width: calc(50% - 10px);
            }
             .confirmation-buttons {
                 gap: 10px; /* Adjust gap */
             }
        }

        @media (max-width: 480px) { /* Phones */
            .game-container {
                padding: 12px;
                border-radius: 12px;
                min-height: 400px;
            }
            h1 {
                font-size: 1.3em;
                margin-bottom: 12px;
            }
            #word-display {
                font-size: 1.6em;
                margin-bottom: 15px;
            }
            .btn {
                padding: 8px 15px;
                font-size: 0.9em;
                min-width: unset; /* Remove min-width on very small screens */
            }
            .choices-container {
                gap: 8px;
            }
            .choice-box {
                flex-basis: calc(50% - 8px); /* Two columns on small screens, adjust for gap */
                max-width: calc(50% - 8px);
                font-size: 0.9em;
                padding: 8px;
                min-height: 45px;
            }
            #score-display, #turn-display {
                font-size: 0.9em;
                margin-top: 12px;
            }
            #final-score {
                font-size: 1.8em;
            }
            #final-message {
                font-size: 1.1em;
            }
            .mode-options-container .btn,
            .start-screen-buttons .btn {
                font-size: 0.85em;
                padding: 10px 6px;
            }
            .confirmation-screen p {
                font-size: 1em;
            }
            #quit-game-button {
                padding: 6px 12px;
                font-size: 0.8em;
            }
            #mode-info-screen h2 {
                font-size: 1.2em;
            }
            #mode-info-screen p, #mode-info-screen ul li {
                font-size: 0.9em;
            }
             .confirmation-buttons .btn {
                 flex-basis: 100%; /* Stack confirmation buttons on very small screens */
                 max-width: 100%;
             }
             .confirmation-buttons {
                 gap: 8px; /* Adjust gap */
             }
        }
         @media (max-width: 320px) { /* Extra small phones */
             .game-container {
                 padding: 8px;
             }
             h1 {
                 font-size: 1.1em;
             }
             #word-display {
                 font-size: 1.4em;
             }
             .btn {
                 font-size: 0.8em;
                 padding: 6px 10px;
             }
              .mode-options-container .btn,
             .start-screen-buttons .btn {
                 font-size: 0.8em;
                 padding: 8px 4px;
             }
             .choice-box {
                 font-size: 0.8em;
                 padding: 6px;
                 min-height: 40px;
             }
             #score-display, #turn-display {
                 font-size: 0.8em;
             }
             #final-score {
                 font-size: 1.6em;
             }
             #final-message {
                 font-size: 1em;
             }
             .confirmation-screen p {
                 font-size: 0.9em;
             }
             #quit-game-button {
                 font-size: 0.7em;
                 padding: 4px 8px;
             }
             #mode-info-screen h2 {
                 font-size: 1em;
             }
             #mode-info-screen p, #mode-info-screen ul li {
                 font-size: 0.8em;
             }
         }
    </style>
</head>
<body>
    <div class="game-container">
        <h1 id="game-title">Word Ddakji: Flip Modes!</h1>

        <div class="game-screen-area">
            <div id="start-screen" class="screen active">
                <p style="font-size: 1.1em; line-height: 1.5; margin-bottom: 25px; text-align: center;">
                    Welcome to Word Ddakji! Test your vocabulary and speed.
                    Choose a mode and try to get 5 correct answers!
                </p>
                <div class="start-screen-buttons">
                    <button id="play-button" class="btn">PLAY GAME</button>
                    <button id="mode-info-button" class="btn btn-secondary">ABOUT</button>
                    <button id="linky-button" class="btn btn-secondary">BACK TO ALTROWEB</button>
                </div>
            </div>

            <div id="mode-selection-screen" class="screen">
                <p class="mode-selection-screen-text">Choose Your Mode:</p>
                <div class="mode-options-container">
                    <button id="antonym-mode-button" class="btn">ANTONYM MODE</button>
                    <button id="synonym-mode-button" class="btn">SYNONYM MODE</button>
                </div>
                <button id="back-to-main-button" class="btn btn-secondary">BACK TO MAIN</button>
            </div>

            <div id="mode-info-screen" class="screen">
                <h2>v0.3.4 BETA</h2>
                <p>The first ever game available, now on AltroWeb!</p>
               <uln>
                    <lin><strong><!--Any Bullet point--></strong><!--Any description here--></li>
                    <lin><strong><!--Any Bullet point--></strong><!--Any description here--></li>
                </uln>
                <p>NOTE: This game is in beta, so it may have bugs, we are trying our best to fix it. Sorry for the inconvenience.<br><br><strong>Changes - v0.1 INIT</strong><br><br>- Initial release<br>- Fixed timer malfunction.
                
                
                <br><br><strong>©AltroWeb - 2Simply Games. All rights reserved.</strong></p>
                <button id="back-from-info-button" class="btn btn-secondary">BACK</button>
            </div>


            <div id="game-screen" class="screen">
                <div id="score-turn-container">
                    <div id="score-display">Score: 0/5</div>
                    <div id="turn-display">Turn: 0/5</div>
                </div>
                <div id="timer-bar-container">
                    <div id="timer-bar"></div>
                </div>
                <p id="word-display">Loading...</p>
                <div class="choices-container" id="choices-container">
                    </div>
                <button id="quit-game-button" class="btn btn-danger">QUIT GAME</button>
            </div>

            <div id="quit-confirmation-screen" class="screen">
                <p>Are you sure you want to quit the current game?</p>
                <div class="confirmation-buttons">
                    <button id="confirm-quit-button" class="btn btn-danger">YES, QUIT</button>
                    <button id="cancel-quit-button" class="btn btn-secondary">NO, CONTINUE</button>
                </div>
            </div>

            <div id="end-screen" class="screen">
                <p id="final-score">Your Score: 0/5</p>
                <p id="final-message">Too poor...</p>
                <button id="restart-button" class="btn">PLAY AGAIN</button>
            </div>
        </div>
    </div>

    <script>
        // --- Game Data ---
        const antonymList = [
            { word: "HAPPY", antonym: "SAD", options: ["JOLLY", "GLAD", "SAD"] },
            { word: "BIG", antonym: "SMALL", options: ["HUGE", "TINY", "SMALL"] },
            { word: "HOT", antonym: "COLD", options: ["WARM", "COLD", "BOILING"] },
            { word: "FAST", antonym: "SLOW", options: ["QUICK", "RAPID", "SLOW"] },
            { word: "BRIGHT", antonym: "DIM", options: ["SHINY", "GLOWING", "DIM"] },
            { word: "LIGHT", antonym: "HEAVY", options: ["EASY", "BRIGHT", "HEAVY"] },
            { word: "OPEN", antonym: "CLOSED", options: ["AJAR", "CLOSED", "WIDE"] },
            { word: "HARD", antonym: "SOFT", options: ["TOUGH", "RIGID", "SOFT"] },
            { word: "RICH", antonym: "POOR", options: ["WEALTHY", "AFFLUENT", "POOR"] },
            { word: "TALL", antonym: "SHORT", options: ["HIGH", "SHORT", "LONG"] },
            { word: "TRUE", antonym: "FALSE", options: ["REAL", "FALSE", "GENUINE"] },
            { word: "BEGIN", antonym: "END", options: ["START", "END", "COMMENCE"] },
            { word: "WIN", antonym: "LOSE", options: ["SUCCEED", "LOSE", "TRIUMPH"] },
            { word: "ABSENT", antonym: "PRESENT", options: ["GONE", "PRESENT", "MISSING"] },
            { word: "ARRIVAL", antonym: "DEPARTURE", options: ["COMING", "DEPARTURE", "ENTRY"] },
            { word: "ANCIENT", antonym: "MODERN", options: ["OLD", "MODERN", "HISTORIC"] },
            { word: "ATTACK", antonym: "DEFEND", options: ["ASSAULT", "DEFEND", "INVADE"] },
            { word: "BLESS", antonym: "CURSE", options: ["SANCTIFY", "CURSE", "PRAISE"] },
            { word: "BOLD", antonym: "TIMID", options: ["BRAVE", "FEARLESS", "TIMID"] },
            { word: "BUILD", antonym: "DESTROY", options: ["CONSTRUCT", "DESTROY", "CREATE"] },
            { word: "CLEVER", antonym: "FOOLISH", options: ["SMART", "FOOLISH", "INTELLIGENT"] },
            { word: "CRUEL", antonym: "KIND", options: ["BRUTAL", "GENTLE", "KIND"] },
            { word: "DRY", antonym: "WET", options: ["ARID", "MOIST", "WET"] },
            { word: "EMPTY", antonym: "FULL", options: ["HOLLOW", "FULL", "VACANT"] },
            { word: "EXPAND", antonym: "CONTRACT", options: ["GROW", "SHRINK", "CONTRACT"] },
            { word: "FAIL", antonym: "SUCCEED", options: ["FLOP", "SUCCEED", "BUNGLE"] },
            { word: "FRIEND", antonym: "ENEMY", options: ["ALLY", "COMPANION", "ENEMY"] },
            { word: "GENEROUS", antonym: "STINGY", options: ["KIND", "STINGY", "GIVING"] },
            { word: "GUILTY", antonym: "INNOCENT", options: ["CULPRIT", "BLAMELESS", "INNOCENT"] },
            { word: "IMPORT", antonym: "EXPORT", options: ["BRING IN", "SEND OUT", "EXPORT"] },
            { word: "INCLUDE", antonym: "EXCLUDE", options: ["CONTAIN", "EXCLUDE", "ENCOMPASS"] },
            { word: "MAJOR", antonym: "MINOR", options: ["BIG", "MINOR", "IMPORTANT"] },
            { word: "OPTIMIST", antonym: "PESSIMIST", options: ["HOPEFUL", "DOUBTER", "PESSIMIST"] },
            { word: "PERMIT", antonym: "FORBID", options: ["ALLOW", "FORBID", "GRANT"] },
            { word: "PLENTY", antonym: "SCARCITY", options: ["ABUNDANCE", "SHORTAGE", "SCARCITY"] },
            { word: "PRIVATE", antonym: "PUBLIC", options: ["SECRET", "PERSONAL", "PUBLIC"] },
            { word: "PUNISH", antonym: "REWARD", options: ["PENALIZE", "REWARD", "CHASTISE"] },
            { word: "ROUGH", antonym: "SMOOTH", options: ["COARSE", "BUMPY", "SMOOTH"] },
            { word: "SHARP", antonym: "BLUNT", options: ["KEEN", "POINTY", "BLUNT"] },
            { word: "SINCERE", antonym: "INSINCERE", options: ["HONEST", "GENUINE", "INSINCERE"] },
            { word: "STALE", antonym: "FRESH", options: ["OLD", "ROTTEN", "FRESH"] },
            { word: "TIGHT", antonym: "LOOSE", options: ["SNUG", "FIRM", "LOOSE"] },
            { word: "TOP", antonym: "BOTTOM", options: ["PEAK", "APEX", "BOTTOM"] },
            { word: "URBAN", antonym: "RURAL", options: ["CITY", "METROPOLITAN", "RURAL"] },
            { word: "VIRTUE", antonym: "VICE", options: ["GOODNESS", "MORALITY", "VICE"] },
            { word: "WEAK", antonym: "STRONG", options: ["FRAIL", "FEEBLE", "STRONG"] },
            { word: "WILD", antonym: "TAME", options: ["UNTAMED", "SAVAGE", "TAME"] },
            { word: "WISE", antonym: "FOOLISH", options: ["CLEVER", "PRUDENT", "FOOLISH"] },
            { word: "YOUTH", antonym: "AGE", options: ["CHILDHOOD", "ADOLESCENCE", "AGE"] },
            { word: "ADVANTAGE", antonym: "DISADVANTAGE", options: ["BENEFIT", "PLUS", "DISADVANTAGE"] }
        ];

        const synonymList = [
            { word: "BEGIN", synonym: "START", options: ["END", "FINISH", "START"] },
            { word: "FAST", synonym: "QUICK", options: ["SLOW", "RAPID", "QUICK"] },
            { word: "JOY", synonym: "HAPPINESS", options: ["SADNESS", "MISERY", "HAPPINESS"] },
            { word: "LARGE", synonym: "BIG", options: ["SMALL", "TINY", "BIG"] },
            { word: "SHOUT", synonym: "YELL", options: ["WHISPER", "MURMUR", "YELL"] },
            { word: "CLEAN", synonym: "TIDY", options: ["DIRTY", "MESSY", "TIDY"] },
            { word: "FINISH", synonym: "COMPLETE", options: ["START", "BEGIN", "COMPLETE"] },
            { word: "HELP", synonym: "ASSIST", options: ["HINDER", "OBSTRUCT", "ASSIST"] },
            { word: "OLD", synonym: "ANCIENT", options: ["NEW", "MODERN", "ANCIENT"] },
            { word: "QUIET", synonym: "SILENT", options: ["LOUD", "NOISY", "SILENT"] },
            { word: "ANGRY", synonym: "FURIOUS", options: ["CALM", "HAPPY", "FURIOUS"] },
            { word: "BRAVE", synonym: "COURAGEOUS", options: ["COWARDLY", "FEARFUL", "COURAGEOUS"] },
            { word: "BUY", synonym: "PURCHASE", options: ["SELL", "GIVE", "PURCHASE"] },
            { word: "DIFFICULT", synonym: "HARD", options: ["EASY", "SIMPLE", "HARD"] },
            { word: "ENJOY", synonym: "DELIGHT", options: ["DISLIKE", "HATE", "DELIGHT"] },
            { word: "EVIL", synonym: "WICKED", options: ["GOOD", "KIND", "WICKED"] },
            { word: "FAMOUS", synonym: "WELL-KNOWN", options: ["UNKNOWN", "OBSCURE", "WELL-KNOWN"] },
            { word: "GATHER", synonym: "COLLECT", options: ["SCATTER", "DISPERSE", "COLLECT"] },
            { word: "GENUINE", synonym: "AUTHENTIC", options: ["FAKE", "FALSE", "AUTHENTIC"] },
            { word: "HIDE", synonym: "CONCEAL", options: ["REVEAL", "SHOW", "CONCEAL"] },
            { word: "IMPORTANT", synonym: "CRUCIAL", options: ["TRIVIAL", "MINOR", "CRUCIAL"] },
            { word: "JOB", synonym: "OCCUPATION", options: ["HOBBY", "PASTIME", "OCCUPATION"] },
            { word: "KILL", synonym: "MURDER", options: ["SAVE", "RESURRECT", "MURDER"] },
            { word: "LAZY", synonym: "IDLE", options: ["ACTIVE", "BUSY", "IDLE"] },
            { word: "LISTEN", synonym: "HEAR", options: ["IGNORE", "OVERLOOK", "HEAR"] },
            { word: "MAJOR", synonym: "PRINCIPAL", options: ["MINOR", "SECONDARY", "PRINCIPAL"] },
            { word: "NICE", synonym: "PLEASANT", options: ["UNPLEASANT", "NASTY", "PLEASANT"] },
            { word: "OBEY", synonym: "COMPLY", options: ["DISOBEY", "REBEL", "COMPLY"] },
            { word: "ODD", synonym: "STRANGE", options: ["NORMAL", "COMMON", "STRANGE"] },
            { word: "PEACE", synonym: "CALM", options: ["WAR", "CONFLICT", "CALM"] },
            { word: "POLITE", synonym: "COURTEOUS", options: ["RUDE", "IMPOLITE", "COURTEOUS"] },
            { word: "QUICKLY", synonym: "RAPIDLY", options: ["SLOWLY", "LEISURELY", "RAPIDLY"] },
            { word: "REMEMBER", synonym: "RECALL", options: ["FORGET", "DISMISS", "RECALL"] },
            { word: "RICH", synonym: "WEALTHY", options: ["POOR", "IMPOVERISHED", "WEALTHY"] },
            { word: "SAD", synonym: "UNHAPPY", options: ["HAPPY", "JOYFUL", "UNHAPPY"] },
            { word: "SMART", synonym: "INTELLIGENT", options: ["STUPID", "DULL", "INTELLIGENT"] },
            { word: "STRONG", synonym: "POWERFUL", options: ["WEAK", "FRAIL", "POWERFUL"] },
            { word: "THINK", synonym: "PONDER", options: ["FORGET", "NEGLECT", "PONDER"] },
            { word: "TRUE", synonym: "CORRECT", options: ["FALSE", "WRONG", "CORRECT"] },
            { word: "UGLY", synonym: "UNATTRACTIVE", options: ["BEAUTIFUL", "PRETTY", "UNATTRACTIVE"] },
            { word: "VACANT", synonym: "EMPTY", options: ["FULL", "OCCUPIED", "EMPTY"] },
            { word: "VICTORY", synonym: "TRIUMPH", options: ["DEFEAT", "LOSS", "TRIUMPH"] },
            { word: "WEAK", synonym: "FRAIL", options: ["STRONG", "ROBUST", "FRAIL"] },
            { word: "WHOLE", synonym: "ENTIRE", options: ["PARTIAL", "INCOMPLETE", "ENTIRE"] },
            { word: "WISE", synonym: "SAGACIOUS", options: ["FOOLISH", "IGNORANT", "SAGACIOUS"] },
            { word: "YELL", synonym: "SHOUT", options: ["WHISPER", "MURMUR", "SHOUT"] },
            { word: "ZEALOUS", synonym: "ENTHUSIASTIC", options: ["APATHETIC", "INDIFFERENT", "ENTHUSIASTIC"] },
            { word: "FORTUNE", synonym: "LUCK", options: ["LUCK", "FATE", "UNLUCKY"] }
        ];

        // --- DOM Elements ---
        const gameTitle = document.getElementById('game-title'); // Get the h1 element
        const startScreen = document.getElementById('start-screen');
        const modeSelectionScreen = document.getElementById('mode-selection-screen');
        const modeInfoScreen = document.getElementById('mode-info-screen'); // New screen element
        const gameScreen = document.getElementById('game-screen');
        const quitConfirmationScreen = document.getElementById('quit-confirmation-screen');
        const endScreen = document.getElementById('end-screen');

        const playButton = document.getElementById('play-button');
        const modeInfoButton = document.getElementById('mode-info-button'); // New button element
        const linkyButton = document.getElementById('linky-button'); // New button element
        const backFromInfoButton = document.getElementById('back-from-info-button'); // New button element
        const antonymModeButton = document.getElementById('antonym-mode-button');
        const synonymModeButton = document.getElementById('synonym-mode-button');
        const backToMainButton = document.getElementById('back-to-main-button');
        const quitGameButton = document.getElementById('quit-game-button');
        const confirmQuitButton = document.getElementById('confirm-quit-button');
        const cancelQuitButton = document.getElementById('cancel-quit-button');
        const restartButton = document.getElementById('restart-button');

        const wordDisplay = document.getElementById('word-display');
        const choicesContainer = document.getElementById('choices-container');
        const scoreDisplay = document.getElementById('score-display');
        const turnDisplay = document.getElementById('turn-display');
        const finalScoreDisplay = document.getElementById('final-score');
        const finalMessageDisplay = document.getElementById('final-message');
        const timerBar = document.getElementById('timer-bar');

        // --- Game State Variables ---
        let currentScore = 0;
        let currentTurn = 0;
        const totalTurns = 5;
        const timePerTurn = 4000; // 4 seconds in milliseconds
        let gameActive = false; // Indicates if a game round is actively running
        let countdownTimer;
        let currentWordData = null; // Stores the data for the word currently being displayed
        let usedWordIndices = new Set(); // To prevent repeating words in a single game session
        let activeWordList = []; // Will be set to antonymList or synonymList
        let currentMode = ''; // 'antonym' or 'synonym'
        let previousScreen = null; // To keep track of the screen before confirmation

        // --- Screen Management Function ---
        function showScreen(screenToShow) {
            const screens = [startScreen, modeSelectionScreen, modeInfoScreen, gameScreen, quitConfirmationScreen, endScreen]; // Add modeInfoScreen
            screens.forEach(screen => {
                if (screen === screenToShow) {
                    screen.classList.add('active');
                } else {
                    screen.classList.remove('active');
                }
            });

            // Only call endGame(false) if we are transitioning away from
            // the game screen AND the game was active (i.e., we are quitting or ending a game).
            // Do NOT call it when simply moving from start screen to mode selection.
            if (gameActive && screenToShow !== gameScreen && screenToShow !== quitConfirmationScreen) {
                 endGame(false); // Clean up game state if game was running and we're leaving it
            } else if (screenToShow !== gameScreen) {
                // Also ensure timer is cleared if we're moving away from game screen for any reason
                clearTimeout(countdownTimer);
            }
        }

        // --- Game Functions ---

        function startGame(mode) {
            currentScore = 0;
            currentTurn = 0;
            usedWordIndices.clear(); // Clear used words for a new game
            gameActive = true;
            currentMode = mode; // Set the current game mode

            // Select the appropriate word list based on mode
            if (currentMode === 'antonym') {
                activeWordList = antonymList;
                gameTitle.textContent = 'Word Ddakji: Antonym Mode'; // Set title for Antonym Mode
            } else if (currentMode === 'synonym') {
                activeWordList = synonymList;
                gameTitle.textContent = 'Word Ddakji: Synonym Mode'; // Set title for Synonym Mode
            } else {
                console.error("Invalid game mode selected.");
                gameTitle.textContent = 'Word Ddakji: Error'; // Indicate error in title
                return; // Prevent game from starting with invalid mode
            }

            // Ensure there are enough words for the game
            if (activeWordList.length < totalTurns) {
                console.error("Not enough words in the list for this game mode!");
                alert("Not enough words for this game mode! Please add more words or reduce total turns.");
                showScreen(modeSelectionScreen); // Go back to mode selection
                gameTitle.textContent = 'Word Ddakji: Select Mode'; // Reset title to mode selection
                return;
            }

            scoreDisplay.textContent = `Score: ${currentScore}/${totalTurns}`;
            turnDisplay.textContent = `Turn: ${currentTurn}/${totalTurns}`;

            showScreen(gameScreen); // Show the game screen
            nextTurn();
        }

        function nextTurn() {
            if (!gameActive) {
                clearTimeout(countdownTimer); // Ensure timer is cleared if game becomes inactive mid-turn
                return;
            }

            clearTimeout(countdownTimer); // Clear any lingering timer from previous turn

            currentTurn++;
            if (currentTurn > totalTurns) {
                endGame(true); // End game and show final score
                return;
            }

            turnDisplay.textContent = `Turn: ${currentTurn}/${totalTurns}`;
            resetChoices();
            displayRandomWord(); // Display word before starting timer
            startTimer(); // Start timer immediately after word is displayed
        }

        function displayRandomWord() {
            let availableWordIndices = [];
            for(let i = 0; i < activeWordList.length; i++) {
                if (!usedWordIndices.has(i)) {
                    availableWordIndices.push(i);
                }
            }

            // If we run out of unique words, reset the used words set and shuffle all words
            // This ensures words repeat only if necessary, for long play sessions
            if (availableWordIndices.length === 0) {
                usedWordIndices.clear();
                // If the game has more turns than unique words, this allows repetition
                for(let i = 0; i < activeWordList.length; i++) {
                    availableWordIndices.push(i);
                }
                 // Shuffle the entire list again if we're reusing words
                 shuffleArray(activeWordList);
            }

            const randomIndex = Math.floor(Math.random() * availableWordIndices.length);
            const selectedIndex = availableWordIndices[randomIndex];
            currentWordData = activeWordList[selectedIndex]; // Store the current word data
            usedWordIndices.add(selectedIndex); // Mark this word's index as used

            wordDisplay.textContent = currentWordData.word;

            const allOptions = [...currentWordData.options];
            shuffleArray(allOptions); // Shuffle the options

            choicesContainer.innerHTML = ''; // Clear previous choices

            allOptions.forEach(option => {
                const choiceBox = document.createElement('div');
                choiceBox.classList.add('choice-box');
                choiceBox.textContent = option;
                // Store the actual correct answer (antonym/synonym) in a data attribute for comparison
                choiceBox.dataset.correctAnswer = (currentMode === 'antonym') ? currentWordData.antonym : currentWordData.synonym;
                choiceBox.addEventListener('click', () => handleChoiceClick(choiceBox));
                choicesContainer.appendChild(choiceBox);
            });
        }

        function handleChoiceClick(chosenBox) {
            if (!gameActive) return; // Important: prevent execution if game has ended or isn't active
            clearTimeout(countdownTimer); // Stop the timer immediately

            const allChoiceBoxes = document.querySelectorAll('.choice-box');
            allChoiceBoxes.forEach(box => {
                box.style.pointerEvents = 'none'; // Disable further clicks
            });

            // Retrieve the correct answer from the currentWordData, not from the chosen box's dataset initially
            const correctAnswer = (currentMode === 'antonym') ? currentWordData.antonym : currentWordData.synonym;

            // Check if the chosen box's textContent matches the correct answer
            // chosenBox can be null if it's a timeout
            const isCorrect = (chosenBox && chosenBox.textContent === correctAnswer);

            if (isCorrect) {
                chosenBox.classList.add('correct');
                currentScore++;
                scoreDisplay.textContent = `Score: ${currentScore}/${totalTurns}`;
            } else {
                // Mark the chosen one as wrong (if it was a user click, not a timeout dummy)
                if (chosenBox) { // Only add 'wrong' class if a box was actually clicked
                    chosenBox.classList.add('wrong');
                }

                // Always highlight the correct answer
                allChoiceBoxes.forEach(box => {
                    if (box.textContent === correctAnswer) {
                        box.classList.add('correct');
                    }
                });
            }

            // Wait a bit for the animation/feedback, then proceed to the next turn
            setTimeout(() => {
                nextTurn();
            }, 1000); // 1 second delay for visual feedback
        }

        function resetChoices() {
            choicesContainer.innerHTML = ''; // Clear choices for the next word
            // Reset timer bar styles
            timerBar.style.transition = 'none'; // Clear previous transition instantly
            timerBar.style.width = '100%'; // Reset width to full
            timerBar.style.backgroundColor = '#ffcc00'; // Reset color to gold
            void timerBar.offsetWidth; // Trigger reflow to apply 'none' transition immediately
        }

        function startTimer() {
            // Apply the actual transition
            timerBar.style.transition = `width ${timePerTurn / 1000}s linear, background-color ${timePerTurn / 1000}s linear`;
            timerBar.style.width = '0%';
            timerBar.style.backgroundColor = '#dc3545'; // Turn red as it depletes

            countdownTimer = setTimeout(() => {
                // When timer runs out, automatically trigger a 'wrong' choice
                // Pass a null for chosenBox, as no user clicked
                handleChoiceClick(null);
            }, timePerTurn);
        }

        // `showFinalScore` boolean parameter decides whether to transition to end screen or just reset game state
        function endGame(showFinalScore = false) {
            gameActive = false; // Game is no longer active
            clearTimeout(countdownTimer); // Ensure any running timer is cleared

            if (showFinalScore) {
                showScreen(endScreen);
                finalScoreDisplay.textContent = `Your Score: ${currentScore}/${totalTurns}`;
                let message = '';
                switch (currentScore) {
                    case 0: message = "Too poor... Keep practicing!"; break;
                    case 1: message = "Needs improvement! Don't give up!"; break;
                    case 2: message = "Just ok! You're getting there."; break;
                    case 3: message = "Good! Not bad at all!"; break;
                    case 4: message = "Great! Almost perfect!"; break;
                    case 5: message = "EXCELLENT! You're a Word Ddakji Master!";
                            triggerConfetti(); // Confetti for perfect score!
                            break;
                    default: message = "Well played!"; break; // Fallback
                }
                finalMessageDisplay.textContent = message;
                gameTitle.textContent = 'Word Ddakji: Game Over'; // Set title for end screen
            } else {
                // If not showing final score (e.g., quitting mid-game), just reset relevant states
                currentScore = 0;
                currentTurn = 0;
                usedWordIndices.clear();
                currentWordData = null;
                // When quitting or going back, reset the title to the default
                gameTitle.textContent = 'Word Ddakji: Flip Modes!';
            }
        }

        function triggerConfetti() {
            const numConfetti = 50;
            const containerRect = document.body.getBoundingClientRect();
            for (let i = 0; i < numConfetti; i++) {
                const confetti = document.createElement('div');
                confetti.classList.add('confetti');
                confetti.style.left = `${Math.random() * 100}%`;
                confetti.style.top = `${containerRect.height - 20}px`;
                confetti.style.animationDelay = `${Math.random() * 0.5}s`;
                confetti.style.transform = `scale(${0.5 + Math.random()})`;
                document.body.appendChild(confetti);

                confetti.addEventListener('animationend', () => {
                    confetti.remove();
                });
            }
        }

        // Fisher-Yates (Knuth) Shuffle for array randomization
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }

        // --- Event Listeners ---
        playButton.addEventListener('click', () => {
            gameActive = false;
            showScreen(modeSelectionScreen);
             gameTitle.textContent = 'Word Ddakji: Select Mode'; // Set title for mode selection
        });

        // New event listener for the Mode Info button
        modeInfoButton.addEventListener('click', () => {
            showScreen(modeInfoScreen);
             gameTitle.textContent = 'Word Ddakji: About'; // Set title for mode info
        });

        // New event listener for the LINKY button
        linkyButton.addEventListener('click', () => {
            window.open('https://www.google.com', '_self'); // Opens Google in the same tab
        });

        // New event listener for the Back button on the Mode Info screen
        backFromInfoButton.addEventListener('click', () => {
            showScreen(startScreen);
            gameTitle.textContent = 'Word Ddakji: Flip Modes!'; // Reset title
        });

        antonymModeButton.addEventListener('click', () => startGame('antonym'));
        synonymModeButton.addEventListener('click', () => startGame('synonym'));

        backToMainButton.addEventListener('click', () => {
            gameActive = false;
            showScreen(startScreen);
            gameTitle.textContent = 'Word Ddakji: Flip Modes!'; // Reset title
        });

        quitGameButton.addEventListener('click', () => {
            previousScreen = gameScreen;
            showScreen(quitConfirmationScreen);
            gameActive = false;
            clearTimeout(countdownTimer);
             gameTitle.textContent = 'Word Ddakji: Quit?'; // Set title for quit confirmation
        });

        confirmQuitButton.addEventListener('click', () => {
            endGame(false); // endGame(false) already resets title
            showScreen(startScreen);
        });

        cancelQuitButton.addEventListener('click', () => {
            gameActive = true;
            showScreen(previousScreen);
            startTimer();
            const allChoiceBoxes = document.querySelectorAll('.choice-box');
            allChoiceBoxes.forEach(box => {
                box.style.pointerEvents = 'auto';
                box.classList.remove('correct', 'wrong');
            });
             // Restore the title based on the screen we're returning to (should be game screen)
             if (previousScreen === gameScreen) {
                 if (currentMode === 'antonym') {
                     gameTitle.textContent = 'Word Ddakji: Antonym Mode';
                 } else if (currentMode === 'synonym') {
                     gameTitle.textContent = 'Word Ddakji: Synonym Mode';
                 }
             }
        });

        restartButton.addEventListener('click', () => {
            showScreen(modeSelectionScreen);
            gameTitle.textContent = 'Word Ddakji: Select Mode'; // Set title for mode selection
        });


        // Initial setup on page load
        document.addEventListener('DOMContentLoaded', () => {
            showScreen(startScreen);
             gameTitle.textContent = 'Word Ddakji: Flip Modes!'; // Set initial title
        });

    </script>
</body>
</html>
